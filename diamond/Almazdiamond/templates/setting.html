{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Engagement Rings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <style>
    /* Reset some default styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: #fff;
      color: #333;
    }

    /* Header styles */
    header {
      background-color: #fff;
      padding: 1rem 2rem;
      border-bottom: 1px solid #e6e6e6;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      text-decoration: none;
      color: #000;
    }

    nav ul {
      list-style: none;
      display: flex;
      gap: 1.5rem;
    }

    nav a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }

    /* Hero / Title Section */
    .collection-hero {
      text-align: center;
      padding: 0rem 1rem 1rem;
    }

    .collection-hero h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .collection-hero p {
      font-size: 1rem;
      color: #666;
      
    }

    /* Filter bar */


    .filter-btn {
      border: 1px solid #ccc;
      padding: 0.5rem 1rem;
      background-color: #fff;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .filter-btn:hover {
      background-color: #f5f5f5;
    }

    /* Product grid */
    #product-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      
      gap: 1rem;
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }

    .product-card {
      border: 2px solid #c5c4c4;
      border-radius: 24px;
      text-align: center;
      padding: 1rem;
      transition: box-shadow 0.3s;
      background-color: #fff;
      width: max-content;
    }

    .product-card:hover {
      box-shadow: 0 2px 8px #0000001a;
      background-color: #f8f8f8;
    }

    .product-card img {
      max-width: 100%;
      height: auto;
      margin-bottom: 0.5rem;
    }

    .product-card h2 {
      font-size: 1rem;
      margin: 0.5rem 0;
      color: #333;
    }

    .product-card .price {
      font-weight: 500;
      color: #333;
      margin-bottom: 0.5rem;
    }

    .product-card .view-details {
      display: inline-block;
      text-decoration: none;
      color: #fff;
      background-color: #333;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      transition: background-color 0.3s;
      border-radius: 24px;
    }

    .product-card .view-details:hover {
      background-color: #555;
    }

    /* Footer */
    footer {
      background-color: #f8f8f8;
      padding: 2rem;
      text-align: center;
      margin-top: 2rem;
      border-top: 1px solid #e6e6e6;
    }

    footer p {
      color: #666;
      font-size: 0.9rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 600px) {
      nav ul {
        display: none; /* Hide nav on very small screens or replace with a menu icon */
      }
    }
    .ring-categories {
        background-color: #fff;
        border-bottom: 1px solid #e6e6e6;
        display: flex;  /* Arrange items in a row */
        flex-wrap: wrap;  /* Allow wrapping if needed */
        justify-content: center;  /* Center items */
        gap: 20px;  /* Add spacing between items */
        padding: 20px;
      }
      
      .ring-categories ul {
        display: flex;              /* displays list items in a row */
        justify-content: center;    /* centers them horizontally */
        list-style: none;
        padding: 1rem;
        margin: 0;
        gap: 1rem;                  /* space between items */
      }
      
      .ring-categories li {
        text-align: center;         /* centers image + text */
      }
      
      .ring-categories a {
        display: flex;
        flex-direction: column;     /* stack image above text */
        align-items: center;        /* center them horizontally */
        text-decoration: none;
        color: #333;
        font-weight: bold;
        transition: background-color 0.3s;
        padding: 0.5rem 1rem;       /* add some padding around the link */
        border-radius: 5px;
      }
      
      .ring-categories a:hover {
        background-color: #f5f5f5;
      }
      
      .ring-categories img {
        width: 40px;                /* adjust icon size as needed */
        height: 40px;
        margin-bottom: 0.25rem;     /* space between icon and text */
      }
      
      .ring-categories span {
        margin-top: 0.25rem;        /* small gap above text (optional) */
      }
    
          /* Reset default styles */
          * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
          }
      
          body {
            font-family: Arial, sans-serif;
            background-color: #fff;
            color: #333;
          }
      
          /* Header styles */
          header {
            background-color: #fff;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e6e6e6;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }
      
          .logo {
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
            color: #000;
          }
      
          nav ul {
            list-style: none;
            display: flex;
            gap: 1.5rem;
          }
      
          nav a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
          }
      
          /* Step Indicator */
          .steps {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
          }
      
          .step {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem 2rem;
            border: 2px solid #ccc;
            border-radius: 50px;
            margin: 0 1rem;
            width: 30%;
            font-weight: bold;
            background-color: #f8f8f8;
            transition: all 0.3s;
          }
      
          .step.active {
            border-color: #000;
            background-color: #000;
            color: #fff;
          }
      
          .step:hover {
            border-color: #666;
            background-color: #ddd;
            color: #000;
          }
  </style>
  <meta name="csrf-token" content="{% csrf_token %}">

</head>
<body>


  <!-- Header -->
  <div id="navbar-container">
   
    {% include 'navbar.html' %}
</div>
<div class="steps">
  <a class="step" href="{% url 'view_cart'%}"> <div>View Cart</div></a>
  <a class="step" href="{% url 'view_wishlist'%}"><div >View Wishlist</div></a>

</div>
<div class="steps">
  <div class="step active">1. Select Setting</div>
  <div class="step">2. Select Stone</div>
  <div class="step">3. Complete Ring</div>
</div>
  <!-- Hero Section -->
  <section class="collection-hero">
    <h1>Engagement Rings</h1>
    <p style="margin-top:1%;">Discover our collection of made-to-order engagement rings and customize to your preferences.</p>
  </section>
 <!-- Ring Categories Container -->
<div class="ring-categories">
  <div class="category" onclick="selectOption('ringCategory', 'Solitaire')">
      <img src="{% static 'img/ringseting.png' %}" alt="Solitaire Icon">
      <div class="category-name">Solitaire</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Halo')">
      <img src="{% static 'img/ringseting.png' %}" alt="Halo Icon">
      <div class="category-name">Halo</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Pave')">
      <img src="{% static 'img/ringseting.png' %}" alt="Pave Icon">
      <div class="category-name">Pave</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Three Stone')">
      <img src="{% static 'img/ringseting.png' %}" alt="Three Stone Icon">
      <div class="category-name">Three Stone</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Nature')">
      <img src="{% static 'img/ringseting.png' %}" alt="Nature Icon">
      <div class="category-name">Nature</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Hidden Halo')">
      <img src="{% static 'img/ringseting.png' %}" alt="Hidden Halo Icon">
      <div class="category-name">Hidden Halo</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'SideStone')">
      <img src="{% static 'img/ringseting.png' %}" alt="SideStone Icon">
      <div class="category-name">SideStone</div>
  </div>
  <div class="category" onclick="selectOption('ringCategory', 'Vintage')">
      <img src="{% static 'img/ringseting.png' %}" alt="Vintage Icon">
      <div class="category-name">Vintage</div>
  </div>
</div>

<h3>Select Metal</h3>
  <div class="ring-categories" id="metalModal">
        
            <div class="option" onclick="selectOption('metal', 'White Gold')">
      <img src="{% static 'img/ringseting.png' %}" alt="Solitaire Icon">
      <div class="category-name"> White Gold</div>
             </div>
            <div class="option" onclick="selectOption('metal', 'Yellow Gold')">
      <img src="{% static 'img/ringseting.png' %}" alt="Solitaire Icon">
      <div class="category-name"> Yellow Gold</div>
      </div>
            <div class="option" onclick="selectOption('metal', 'Rose Gold')">
              <img src="{% static 'img/ringseting.png' %}" alt="Solitaire Icon">
                <div class="category-name">Rose Gold</div>
          </div>
            <div class="option" onclick="selectOption('metal', 'Platinum')">
              <img src="{% static 'img/ringseting.png' %}" alt="Solitaire Icon">
                <div class="category-name">Platinum</div></div>
       
        <!-- <button class="close-btn" onclick="closeModal('metalModal')">Close</button> -->
    
</div>

<div class="ring-categories">
  <div class="category-option" onclick="selectOption('shape', 'Round')">
      <img src="{% static 'img/ringseting.png' %}" alt="Round Icon">
      <span>Round</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Oval')">
      <img src="{% static 'img/ringseting.png' %}" alt="Oval Icon">
      <span>Oval</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Pear')">
      <img src="{% static 'img/ringseting.png' %}" alt="Pear Icon">
      <span>Pear</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'E-Cushion')">
      <img src="{% static 'img/ringseting.png' %}" alt="E-Cushion Icon">
      <span>E-Cushion</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Cushion')">
      <img src="{% static 'img/ringseting.png' %}" alt="Cushion Icon">
      <span>Cushion</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Emerald')">
      <img src="{% static 'img/ringseting.png' %}" alt="Emerald Icon">
      <span>Emerald</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Princess')">
      <img src="{% static 'img/ringseting.png' %}" alt="Princess Icon">
      <span>Princess</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Marquise')">
      <img src="{% static 'img/ringseting.png' %}" alt="Marquise Icon">
      <span>Marquise</span>
  </div>
  <div class="category-option" onclick="selectOption('shape', 'Radiant')">
      <img src="{% static 'img/ringseting.png' %}" alt="Radiant Icon">
      <span>Radiant</span>
  </div>
</div>


 <select id="price_sort" onchange="selectOption('price_sort', this.value)">
  <option value="High to Low"{%if price_sort == 'High to Low' %} selected {%endif%}>
    High to Low
  </option>
  <option value="Low to High"{%if price_sort == 'Low to High' %} selected {%endif%}>
    Low to High
  </option>
  
 </select>

  <!-- Product Grid -->
  
  <div id="product-grid">
    <!-- Product Card 1 -->
    {%for i in ring_variants%}
    <div class="product-card" id="cards">
      <img src="{{i.image.url}}" alt="{{i.name}}" style="width:100px;height:100px"/>
      <h2>{{i.ring.name}}</h2>
      <p class="price">{{i.currency}}  {{i.price}}</p>
     <div style="display: flex;justify-content:space-evenly;gap:18px;margin-top:10%;">
      <a href="{%if stone_id %}{%url 'stone_get_more_ring_details' i.id stone_id%}{%else%}{%url 'get_more_ring_details' i.id %}{%endif%}" class="view-details" style="background-color: #fff;color:#000;border:2px solid;">More Info</a>
      <a href="{%if stone_id %}{%url 'stone_get_more_ring_details' i.id stone_id%}{%else%}{%url 'get_more_ring_details' i.id %}{%endif%}" class="view-details">Complete Ring</a>
      </div>
     <div style="display: flex;justify-content:space-evenly;gap:18px;margin-top:10%;">
      <a onclick="addto_cart('{{i.id}}')">Add to cart</a>
      <a onclick="addto_wishlist('{{i.id}}')" class="view-details" style="background-color: #fff;color:#000;border:2px solid;">Add Wishlist</a>
      
    </div>
    </div>
{%endfor%}
    <!-- Product Card 2 -->
    
    <!-- Add more products as needed -->
  </div>
  <div class="newsletter-section">
    <h2>SUBSCRIBE TO OUR NEWSLETTER</h2>
    <div class="newsletter-form">
        <input type="email" placeholder="ENTER YOUR EMAIL">
        <button>SUBSCRIBE</button>
    </div>
</div>

<div class="features-section">
    <div class="feature">
        <img src="worldwide-delivery-icon.png" alt="Worldwide Delivery">
        <h3>Worldwide Delivery</h3>
        <p>Overnight Complimentary Shipping</p>
    </div>
    <div class="divider"></div>
    <div class="feature">
        <img src="returns-icon.png" alt="Returns Within 30 Days">
        <h3>Returns Within 30 Days</h3>
        <p>Satisfaction Guaranteed</p>
    </div>
    <div class="divider"></div>
    <div class="feature">
        <img src="warranty-icon.png" alt="Lifetime Warranty">
        <h3>Lifetime Warranty</h3>
        <p>Shop With Confidence</p>
    </div>
</div>
  <!-- Footer -->
  <div id="footer-container">
    {% include 'footer.html' %}
</div>
<script>
 function filter_ring_setting(key,value){
    var url = `/ring-settings?${key}=${value}`;
    window.location.href=url;
 }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>


function selectOption(category, value) {
  let defaultOptions = {
    metal: 'White Gold',
    shape: 'Round',
    price_sort: 'High to Low',
};

// Retrieve selectedOptions from localStorage, or use defaultOptions
let selectedOptions = localStorage.getItem("selectedOptions");
console.log(selectedOptions,"kkkjkjjjjjhgfghj")
if (selectedOptions && selectedOptions.startsWith("{")) { // Check if it's valid JSON
    try {
        selectedOptions = JSON.parse(selectedOptions); 
        console.log("Parsed successfully:", selectedOptions);
    } catch (error) {
        console.error("Error parsing JSON:", error);
        selectedOptions = defaultOptions;
    }
} else {
    console.warn("Invalid or missing localStorage data. Using default options.");
    selectedOptions = defaultOptions;
}
console.log(selectedOptions.metal,"selectedOptions")
  console.log(selectedOptions,"mmmmmmmmmm");
    selectedOptions[category] = value;  // Update selection
    console.log(selectedOptions);  // Debugging
    sendPostRequest(selectedOptions);


// Send data to the backend and store in localStorage
function sendPostRequest(selectedOptions) {
  console.log("Sending:", selectedOptions);
   let stone_id='{{stone_id}}';
   let url;
   if(stone_id!='None'){
    url=`/ring-settings/${stone_id}`;
   }
   else{
    url=`/ring-settings`;
   }
  fetch(url, {
      method: 'POST',
      headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Content-Type': 'application/json'
      },
      body: JSON.stringify(selectedOptions)
  })
  .then(response => response.json())
  .then(data => {
      console.log("Success:", data);
      localStorage.setItem("selectedOptions", JSON.stringify(selectedOptions));
      let rings=data['data'],stone_id=data['stone_id'];
      updateProductGrid(rings,stone_id);  // Call function to update the product grid
  })
  .catch(error => console.error("Error:", error));
}

function updateProductGrid(rings,stone_id) {
  console.log(rings,"klkkkkkkkkkkkkkkkkkkkkkkkkkk")
  const productGrid = document.getElementById('product-grid');
  productGrid.innerHTML = '';  // Clear existing content

  rings.forEach(ring => {
      const card = document.createElement('div');
      card.className = 'product-card';
      card.innerHTML = `
          <img src="/media/${ring.image}" alt="${ring.ring_settings}" style="width:100px;height:100px"/>
          <h2>${ring.ring__name}mmmmmmmm</h2>
          <p class="price">${ring.currency} ${ring.price}</p>
          <div style="display: flex;justify-content:space-evenly;gap:18px;margin-top:10%;">
              <a href="{%if stone_id != null %}/ring-details/${ring.id}/${stone_id}{%else%}/ring-details/${ring.id}{%endif%}" class="view-details" style="background-color: #fff;color:#000;border:2px solid;">More Info</a>
              <a href="{%if stone_id != null %}/ring-details/${ring.id}/${stone_id}{%else%}/ring-details/${ring.id}{%endif%}" class="view-details">Complete Ring</a>
          </div>
          <div style="display: flex; justify-content: space-evenly; gap: 18px; margin-top: 10%;">
        <a href="javascript:void(0);" onclick="addto_cart('${ring.id}')" class="view-details">Add to Cart</a>
        <a href="javascript:void(0);" onclick="addto_wishlist('${ring.id}')" class="view-details" style="background-color: #fff; color:#000; border:2px solid;">Add Wishlist</a>
    </div>
      `;
      productGrid.appendChild(card);
  });
}
}
function addto_cart(item_id){
  let url=`/addto_cart`;
  let seleted_product={
    ring_variant_id:item_id
  }
     
    fetch(url, {
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(seleted_product)
    })
    .then(response => response.json())
    .then(data => {
        console.log("Success:", data);
    });
  }
function addto_wishlist(item_id){
let url=`/addto_wishlist`;
let seleted_product={
  ring_variant_id:item_id
}
   
  fetch(url, {
      method: 'POST',
      headers: {
          'X-CSRFToken': '{{ csrf_token }}',
          'Content-Type': 'application/json'
      },
      body: JSON.stringify(seleted_product)
  })
  .then(response => response.json())
  .then(data => {
      console.log("Success:", data);
  });
}
</script>
</body>
</html>
